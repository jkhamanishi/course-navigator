<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
var data = [];

function openFile(event){
    var input = event.target;

    var reader = new FileReader();
    reader.onload = function(){
        console.log('file successfully loaded')
        var output = document.getElementById('out');
        output.innerHTML = reader.result;
        data = data2array(reader.result);
        array2code(data);
    };
    reader.readAsBinaryString(input.files[0]);
};

function data2array(data){
    var newValue = ",";
    var newLine = "\n";
    // console.log('this:'+newValue + ' this:'+newLine)
    
    var lines = data.split(newLine);
    var titles = lines[0].split(newLine)[0].split(newValue);
    // titles[titles.length-1] = titles[titles.length-1].split(titles[titles.length-1].charAt(titles[titles.length-1].length - 1))[0]
    var data = new Array(lines.length - 1);

    for (var i = 1; i < lines.length; i++) {
        data[i - 1] = [];
        lines[i] = lines[i].split(newValue);
        for (var j = 0; j < titles.length; j++) {
            //every last value in each row contains some sort of bad character at the end
            if (j == (titles.length-1)){
                lines[i][j] = lines[i][j].split(lines[i][j].charAt(lines[i][j].length - 1))[0]
            }
            //data[i - 1][titles[j]] = lines[i][j];
            data[i - 1][j] = lines[i][j];
        };
    };

    // console.log(data);
    return data;
}


function array2code(array){
    var text = "var data = ["
    
    for (var i=0; i<array.length; i++){ // for every row
        text = text + "["
        
        for (var j=0; j<array[0].length; j++){ // for every column
            text = text + "\"" + array[i][j] + "\", "
        }
        
        text = text + "],"
    }
    
    text = text + "];"
    document.getElementById('code').innerHTML = text;
}


function copyToClipboard(element) {
    var $temp = $("<input>");
    $("body").append($temp);
    $temp.val($(element).text()).select();
    document.execCommand("copy");
    $temp.remove();
}
function copied(ele){
    var temp = ele;
    $(temp).text("Copied");
}

</script>


<style>
code {
    background-color: #eee;
    border: 1px solid #999;
    display: block;
    padding: 20px;
    overflow-wrap: anywhere;
}
</style>


<body>

<h1>.csv to .js array</h1>

<input type='file' accept='text/csv' onchange='openFile(event)'><br><br>

<code id="code">JavaScript array will appear here</code>
<button id="copyButton" onclick="copied('#copyButton'); copyToClipboard('#code')">Copy Code</button>

<br><br><br>

<p>.csv contents:</p>
<output id="out">file contents will appear here</output>

</body>








